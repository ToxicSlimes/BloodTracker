using System;

namespace BloodTracker.Infrastructure.Services;

internal static class BloodTestNameMapper
{
    public static readonly Dictionary<string, string[]> NameMappings = new(StringComparer.OrdinalIgnoreCase)
    {
        ["free-testosterone"] = ["Тестостерон свободный", "свободный (расч", "свободный"],
        ["testosterone"] = ["Тестостерон общий"],
        ["lh"] = ["Лютеинизирующий гормон", "гормон (ЛГ)", "(ЛГ)"],
        ["fsh"] = ["Фолликулостимулирующий гормон", "гормон (ФСГ)", "(ФСГ)"],
        ["prolactin"] = ["Пролактин"],
        ["estradiol"] = ["Эстрадиол"],
        ["shbg"] = ["ГСПГ", "Глобулин, связывающий половые", "связывающий половые", "SHBG"],
        ["tsh"] = ["Тиреотропный гормон", "гормон (ТТГ)", "(ТТГ)", "(TTT)", "ТТГ)"],
        ["igf1"] = ["ИФР-1", "IGF-1", "Соматомедин"],
        ["fai"] = ["Индекс свободных андрогенов", "свободных андрогенов"],
        
        ["hdl"] = ["ЛПВП", "HDL", "высокой плотности", "(ЛПВП", "ЛПВП,", "липопротеидов высокой"],
        ["ldl"] = ["ЛПНП", "LDL", "низкой плотности", "(ЛПНП", "ЛПНП,", "липопротеидов низкой", "JITTHIT"],
        ["vldl"] = ["ЛПОНП", "VLDL", "очень низкой плотности", "Липопротеиды очень низкой", "ЛПОНП (VLDL)", "ЛПОНП"],
        ["non-hdl-cholesterol"] = ["Холестерин не-ЛПВП", "не-ЛПВП", "не ЛПВП", "Холестерин не ЛПВП"],
        ["triglycerides"] = ["Триглицериды"],
        ["cholesterol"] = ["Холестерин общий", "Холестерол общий", "Холестерин общ", "Холестерин"],
        ["atherogenic"] = ["Коэффициент атерогенности", "атерогенности"],
        
        ["alt"] = ["Аланинаминотрансфераза", "(АЛТ)", "АЛТ)", "АЛТ"],
        ["ast"] = ["Аспартатаминотрансфераза", "(АСТ)", "АСТ)", "АСТ", "Аспартат"],
        ["ggt"] = ["Гамма-глутамилтрансфераза", "(ГГТ)", "ГГТ)", "ГГТ"],
        ["alp"] = ["Щелочная фосфатаза", "Щелочная", "фосфатаза"],
        
        ["bilirubin-direct"] = ["Билирубин прямой", "Билирубин, прямой", "прямой"],
        ["bilirubin"] = ["Билирубин общий", "Билирубин, общий", "Билирубин o6щий", "Билирубин общ"],
        
        ["glucose"] = ["Глюкоза"],
        ["hba1c"] = ["Гликированный гемоглобин", "HbA1c"],
        ["creatinine"] = ["Креатинин"],
        ["urea"] = ["Мочевина"],
        ["protein"] = ["Общий белок", "белок общий", "Белок общий", "белок"],
        ["vitd"] = ["Витамин D", "25-OH", "25-ОН"],
        
        ["pt"] = ["Протромбиновое время"],
        ["pt-percent"] = ["Протромбин %", "по Квику", "Протромбин % (по"],
        ["inr"] = ["МНО", "нормализованное отношение", "INR", "(МНО)", "отношение (МНО)"],
        
        ["hemoglobin"] = ["Гемоглобин"],
        ["hematocrit"] = ["Гематокрит"]
    };

    public static readonly Dictionary<string, (double Min, double Max)> ExpectedRanges = new()
    {
        ["testosterone"] = (5, 50),
        ["free-testosterone"] = (0.1, 2),
        ["lh"] = (0.3, 20),
        ["fsh"] = (0.3, 20),
        ["prolactin"] = (50, 1000),
        ["estradiol"] = (10, 300),
        ["shbg"] = (10, 100),
        ["tsh"] = (0.1, 10),
        ["igf1"] = (50, 500),
        ["fai"] = (10, 200),
        ["cholesterol"] = (2, 10),
        ["hdl"] = (0.5, 3),
        ["ldl"] = (0.5, 6),
        ["triglycerides"] = (0.3, 5),
        ["vldl"] = (0.1, 2),
        ["atherogenic"] = (0.5, 10),
        ["non-hdl-cholesterol"] = (1, 8),
        ["alt"] = (5, 200),
        ["ast"] = (5, 200),
        ["ggt"] = (5, 150),
        ["alp"] = (20, 300),
        ["bilirubin"] = (2, 50),
        ["bilirubin-direct"] = (0.5, 15),
        ["glucose"] = (2, 15),
        ["hba1c"] = (3, 15),
        ["creatinine"] = (30, 200),
        ["urea"] = (1, 20),
        ["protein"] = (50, 100),
        ["vitd"] = (5, 200),
        ["pt"] = (8, 25),
        ["pt-percent"] = (50, 150),
        ["inr"] = (0.5, 2),
        ["hemoglobin"] = (80, 200),
        ["hematocrit"] = (25, 60)
    };

    public static bool ValidateValue(string key, double value)
    {
        if (!ExpectedRanges.TryGetValue(key, out var range))
            return true;
        
        return value >= range.Min && value <= range.Max;
    }
}
