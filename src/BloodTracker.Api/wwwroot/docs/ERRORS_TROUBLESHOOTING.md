# –û—à–∏–±–∫–∏ –∏ troubleshooting

## üîÑ –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π reload –ø—Ä–∏ 401

**–°–∏–º–ø—Ç–æ–º:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª–µ –ø–æ—Å–ª–µ –ø—Ä–æ—Ç—É—Ö–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ä—ã–π –∫–æ–¥ –≤ `handle401()` –¥–µ–ª–∞–ª `window.location.reload()`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π `init()` ‚Üí –Ω–æ–≤—ã–π API-–∑–∞–ø—Ä–æ—Å ‚Üí —Å–Ω–æ–≤–∞ 401.

**–†–µ—à–µ–Ω–∏–µ (—É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ):** `handle401()` –¥–∏—Å–ø–∞—Ç—á–∏—Ç event `bt:unauthorized`, main.js —Å–ª—É—à–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç login overlay –±–µ–∑ reload:
```js
// api.js
function handle401() {
    localStorage.removeItem('bt_token');
    localStorage.removeItem('bt_user');
    window.dispatchEvent(new Event('bt:unauthorized'));
}
```

**–ï—Å–ª–∏ –±–∞–≥ –≤–µ—Ä–Ω—É–ª—Å—è:** –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –Ω–∏–≥–¥–µ –Ω–µ—Ç `window.location.reload()` –ø—Ä–∏ 401.

---

## üñ• Login overlay –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã

**–°–∏–º–ø—Ç–æ–º:** –î–≤–∞ login overlay –Ω–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** `bt:unauthorized` –º–æ–∂–µ—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö API-–∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ).

**–ó–∞—â–∏—Ç–∞ (—É–∂–µ –µ—Å—Ç—å):**
```js
// main.js
window.addEventListener('bt:unauthorized', async () => {
    if (document.getElementById('login-overlay')) return; // skip –µ—Å–ª–∏ —É–∂–µ –ø–æ–∫–∞–∑–∞–Ω
    ...
});
```

---

## üì± ASCII-–∞—Ä—Ç –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è / –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —ç–∫—Ä–∞–Ω

**–°–∏–º–ø—Ç–æ–º:** ASCII skull –∏–ª–∏ muscle ascii –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:** `scaleAsciiSkull()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–º–µ–Ω—å—à–∞–µ—Ç font-size. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ resize —Å debounce:
```js
window.addEventListener('resize', () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => scaleAsciiSkull(), 150);
});
```

**–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `.ascii-skull-container` –∏–º–µ–µ—Ç `width: 100%` –∏ `overflow: hidden`.

---

## üé® –¶–≤–µ—Ç –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ setColor()

**–°–∏–º–ø—Ç–æ–º:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞—Ä–æ–≥–æ —Ü–≤–µ—Ç–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** `setColor()` –º–µ–Ω—è–µ—Ç CSS variables –Ω–∞ `:root`. –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç hardcoded —Ü–≤–µ—Ç (–Ω–µ var), –æ–Ω –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `var(--primary-color)`, `var(--text-primary)`, `rgba(var(--primary-rgb), 0.5)` –≤ CSS. –ü—Ä–æ–≤–µ—Ä—å –Ω–µ—Ç –ª–∏ –∏–Ω–ª–∞–π–Ω-—Å—Ç–∏–ª–µ–π —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏.

---

## üìä ApexCharts –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º:** –ü—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ –≤–º–µ—Å—Ç–æ –≥—Ä–∞—Ñ–∏–∫–∞.

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ApexCharts –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ index.html
2. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ DOM –≤ –º–æ–º–µ–Ω—Ç —Ä–µ–Ω–¥–µ—Ä–∞ (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–∫—Ä—ã—Ç–∞)
3. –î–∞–Ω–Ω—ã—Ö –º–µ–Ω—å—à–µ 2 —Ç–æ—á–µ–∫ (–¥–ª—è trend chart)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å, –∏—â–∏ –æ—à–∏–±–∫–∏ `ApexCharts is not defined` –∏–ª–∏ `Cannot read properties of null`.

---

## üîê Admin tab –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å admin, –Ω–æ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ –≤–∏–¥–Ω–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** `auth.isAdmin()` –ø–∞—Ä—Å–∏—Ç JWT –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `role === 'admin'`. –ï—Å–ª–∏ JWT –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç claim `role`, –º–µ—Ç–æ–¥ –≤–µ—Ä–Ω—ë—Ç false.

**–¢–∞–∫–∂–µ:** –ü—Ä–∏ impersonation admin-tab —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è:
```js
adminBtn.style.display = (auth.isAdmin() && !auth.isImpersonating()) ? '' : 'none'
```

---

## üî• Matrix runes —Ç–æ—Ä–º–æ–∑—è—Ç

**–°–∏–º–ø—Ç–æ–º:** –ù–∏–∑–∫–∏–π FPS, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.

**–ü—Ä–∏—á–∏–Ω–∞:** Canvas —Ä–∏—Å—É–µ—Ç —Å–æ—Ç–Ω–∏ —Ä—É–Ω –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä.

**–†–µ—à–µ–Ω–∏–µ:** –í `matrix-runes.js` –µ—Å—Ç—å FPS throttle (60 FPS cap). –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è ‚Äî —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å spacing.

---

## üíæ CORS –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ ASCII Engine

**–°–∏–º–ø—Ç–æ–º:** `Failed to load image from URL` –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ URL.

**–ü—Ä–∏—á–∏–Ω–∞:** `img.crossOrigin = 'anonymous'` —Ç—Ä–µ–±—É–µ—Ç CORS-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª–æ–≤—ã–π upload –≤–º–µ—Å—Ç–æ URL, –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å —Å–µ—Ä–≤–µ—Ä–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö CORS.

---

## üìã Autocomplete –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º:** Dropdown –∫–∞—Ç–∞–ª–æ–≥–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º.

**–ü—Ä–∏—á–∏–Ω–∞:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –≤–Ω–µ dropdown –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç.

**–ó–∞—â–∏—Ç–∞ (—É–∂–µ –µ—Å—Ç—å):**
```js
document.addEventListener('click', (e) => {
    if (!e.target.closest('.catalog-autocomplete')) dropdown.classList.remove('active')
})
```

**–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –∫–ª–∏–∫ –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è `stopPropagation()`.

---

## üèãÔ∏è Workouts –∑–∞–≥—Ä—É–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–°–∏–º–ø—Ç–æ–º:** 401 –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –ø–æ—Ç–æ–º –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª.

**–ü—Ä–∏—á–∏–Ω–∞:** `initWorkouts()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ (—É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ):** `initWorkouts()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ `init()` –≤ main.js, –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ `auth.isLoggedIn()`. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ workouts.js:
```js
// Initialization is called from main.js init() after auth check passes.
// Do NOT auto-init here ‚Äî it would fire before auth and trigger 401 reload loops.
```

---

## üñã ASCIIfy —Ä–µ–Ω–¥–µ—Ä–∏—Ç –ø—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç

**–°–∏–º–ø—Ç–æ–º:** `data-asciify` —ç–ª–µ–º–µ–Ω—Ç –ø—É—Å—Ç–æ–π.

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –¢–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–º–≤–æ–ª—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ `FONT` (asciifyEngine.js)
2. `asciify.enabled === false` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–∫–ª—é—á–∏–ª)
3. –≠–ª–µ–º–µ–Ω—Ç –µ—â—ë –Ω–µ –∏–º–µ–µ—Ç textContent –≤ –º–æ–º–µ–Ω—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** `window.asciify.enabled` –≤ –∫–æ–Ω—Å–æ–ª–∏. –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–æ–≤–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ ‚Äî –¥–æ–±–∞–≤—å –µ–≥–æ –≤ –æ–±—ä–µ–∫—Ç `F` –≤ asciifyEngine.js.
